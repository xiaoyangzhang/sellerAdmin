<table border="0" class="table tab-inputgroup base-info">
	<tbody>
		<tr>
			<td>商品类型：</td>
			<td>$!{itemType.text}</td>
		</tr>
		<tr>
			<td>*商品标题：</td>
			<td><input type="text" class="form-control item-name" placeholder="用户名 38字以内" maxlength="38"></td>
		</tr>
		<tr>
			<td>商品代码：</td>
			<td><input type="text" class="form-control item-code" placeholder="请输入商品编号"/></td>
		</tr>
		<tr>
			<td>*出发地：</td>
			 <td><span id="departs-content"></span><button type="button" class="btn btn-success select-departs">选择出发地</button></td>
		</tr>
		<tr>
			<td>*目的地：</td>
			<td><span id="dests-content"></span><button type="button" class="btn btn-success select-dests">选择目的地</button></td>
		</tr>
		<tr>
			<td>*行程天数（天）：</td>
			<td><input type="text" class="form-control days" placeholder="请填写整数"/></td>
		</tr>
		<tr>
			<td>*线路亮点：</td>
			<td>
				<textarea class="form-control textarea-count description" rows="3" placeholder="请输入亮点描述" maxlength="200"></textarea>
				<span class="word-num">0/200字</span>
			</td>
		</tr>
		<tr>
			<td>*线路主题：</td>
			<td>
				#foreach($theme in $themes)
					<label>
						<input type="checkbox" class="productTag" rId="${theme.id}" rName="${theme.name}" #if($product.baseInfo.containsTag($theme.id)) checked #end/>${theme.name}
					</label>
				#end
			</td>
		</tr>
		<tr>
			<td>*商品图：</td>
			<td>
				<div class="uploadbox clearfix">
					<div class="imgbox">
						<div class="dimg">
							<img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
						</div>
						<div class="upimgbtn">
							<input type="file" name="picfile" class="picfile">
							<button class="upl">上传图片</button>
							<button class="del">删除图片</button>
						</div>
					</div>
					<div class="imgbox">
						<div class="dimg">
							<img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
						</div>
						<div class="upimgbtn">
							<input type="file" name="picfile" class="picfile">
							<button class="upl">上传图片</button>
							<button class="del">删除图片</button>
						</div>
					</div>
					<div class="imgbox">
						<div class="dimg">
							<img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
						</div>
						<div class="upimgbtn">
							<input type="file" name="picfile" class="picfile">
							<button class="upl">上传图片</button>
							<button class="del">删除图片</button>
						</div>
					</div>
					<div class="imgbox">
						<div class="dimg">
							<img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==">
						</div>
						<div class="upimgbtn">
							<input type="file" name="picfile" class="picfile">
							<button class="upl">上传图片</button>
							<button class="del">删除图片</button>
						</div>
					</div>
				</div>
			</td>
		</tr>
	</tbody>
</table>
<script type="text/javascript">
	$(document).delegate(".departs",'click',function() { 
		$(this).remove();
    });
	$(".select-departs").click(function() {
		openModalForForm('$!{utilWebconfig.getActionDefaultFontPath()}/B2C/resourceForSelect/selectTravelKa','选择旅游咖 ',function() {
			var kas = win.getItems();
			var content = $(".departs-content");
			for(var i in kas) {
				var ka = kas[i];
				var name = ka.nickName || ka.name;
				if($(".masters[rName='"+ka.name+"']").length > 0) continue;
				var btn = $("<button class='btn btn-info masters'>"+name+"</button>");
				btn.click(function(){
					$(this).remove();
				});
				btn.attr("rName",ka.name);
				content.append("  ").append(btn);
			}
			//console.log(JSON.stringify(kas));
			//一般设定yes回调，必须进行手工关闭
			return true;
		});
	});
	$(document).delegate(".dests",'click',function() { 
		$(this).remove();
    });
	$(".select-dests").click(function() {
		openModalForForm('$!{utilWebconfig.getActionDefaultFontPath()}/B2C/resourceForSelect/selectTravelKa','选择旅游咖 ',function() {
			var kas = win.getItems();
			var content = $(".dests-content");
			for(var i in kas) {
				var ka = kas[i];
				var name = ka.nickName || ka.name;
				if($(".masters[rName='"+ka.name+"']").length > 0) continue;
				var btn = $("<button class='btn btn-info masters'>"+name+"</button>");
				btn.click(function(){
					$(this).remove();
				});
				btn.attr("rName",ka.name);
				content.append("  ").append(btn);
			}
			//console.log(JSON.stringify(kas));
			//一般设定yes回调，必须进行手工关闭
			return true;
		});
	});
	// 获取行程信息
	function getBaseInfo() {
        var picUrls = [];
		var themes = [];
		$(".productTag:checked").each(function(){
			themes.push($(this).attr("rId"));
		});
		var departs = [];
		var dests = [];
		var result = {
			#if($product)
			lineId:$!{product.baseInfo.lineId},
			itemId:$!{product.baseInfo.itemId},
			#end
			categoryId:$!{categoryId},
			type:$!{itemType.value},
			name:$(".item-name").val(),
			code:$(".item-code").val(),
            picUrls:picUrls,
			days:$(".days").val() || 0,
			description:$(".description").val(),
			themes:themes,
			departs:departs,
			dests:dests
		};
		var departs = [];
		return result;
	}
    function delPic(obj) {
        $(obj).prev().remove();
        $(obj).remove();
    }
</script>